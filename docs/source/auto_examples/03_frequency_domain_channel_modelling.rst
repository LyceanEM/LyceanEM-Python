
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples\03_frequency_domain_channel_modelling.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_03_frequency_domain_channel_modelling.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_03_frequency_domain_channel_modelling.py:


Modelling a Physical Channel in the Frequency Domain
======================================================

This example uses the frequency domain :func:`lyceanem.models.frequency_domain.calculate_scattering` function to
predict the scattering parameters for the frequency and environment included in the model.
This model allows for a very wide range of antennas and antenna arrays to be considered, but for simplicity only horn
antennas will be included in this example. The simplest case would be a single source point and single receive point,
rather than an aperture antenna such as a horn.

.. GENERATED FROM PYTHON SOURCE LINES 16-20

.. code-block:: Python



    import numpy as np








.. GENERATED FROM PYTHON SOURCE LINES 21-24

Frequency and Mesh Resolution
------------------------------


.. GENERATED FROM PYTHON SOURCE LINES 24-28

.. code-block:: Python

    freq = np.asarray(24.0e9)
    wavelength = 3e8 / freq
    mesh_resolution = 0.5 * wavelength








.. GENERATED FROM PYTHON SOURCE LINES 29-32

Setup transmitters and receivers
-----------------------------------


.. GENERATED FROM PYTHON SOURCE LINES 32-44

.. code-block:: Python

    import lyceanem.geometry.targets as TL
    import lyceanem.geometry.geometryfunctions as GF


    transmit_horn_structure, transmitting_antenna_surface_coords = TL.meshedHorn(
        58e-3, 58e-3, 128e-3, 2e-3, 0.21, mesh_resolution
    )

    receive_horn_structure, receiving_antenna_surface_coords = TL.meshedHorn(
        58e-3, 58e-3, 128e-3, 2e-3, 0.21, mesh_resolution
    )








.. GENERATED FROM PYTHON SOURCE LINES 45-50

Position Transmitter
----------------------
rotate the transmitting antenna to the desired orientation, and then translate to final position.
:func:`lyceanem.geometryfunctions.mesh_rotate` and :func:`lyceanem.geometryfunctions.mesh_translate` are used to achive this


.. GENERATED FROM PYTHON SOURCE LINES 50-67

.. code-block:: Python

    rotation_vector1 = np.radians(np.asarray([90.0, 0.0, 0.0]))
    rotation_vector2 = np.radians(np.asarray([0.0, 0.0, -90.0]))
    rotation_vector3 = np.radians(np.asarray([0.0, 0.0, 90.0]))
    transmit_horn_structure = GF.mesh_rotate(
        transmit_horn_structure,
        rotation_vector1
    )
    transmit_horn_structure = GF.mesh_rotate(transmit_horn_structure,rotation_vector2)

    transmit_horn_structure = GF.mesh_translate(transmit_horn_structure,np.asarray([2.529, 0, 0]))

    transmitting_antenna_surface_coords = GF.mesh_rotate(transmitting_antenna_surface_coords,rotation_vector1)

    transmitting_antenna_surface_coords = GF.mesh_rotate(
        transmitting_antenna_surface_coords,rotation_vector2)

    transmitting_antenna_surface_coords = GF.mesh_translate(transmitting_antenna_surface_coords,np.asarray([2.529, 0, 0]))







.. GENERATED FROM PYTHON SOURCE LINES 68-71

Position Receiver
------------------
rotate the receiving horn to desired orientation and translate to final position.

.. GENERATED FROM PYTHON SOURCE LINES 71-79

.. code-block:: Python


    receive_horn_structure = GF.mesh_rotate(receive_horn_structure,rotation_vector1)
    #receive_horn_structure = GF.mesh_rotate(receive_horn_structure,rotation_vector3)
    receive_horn_structure = GF.mesh_translate(receive_horn_structure,np.asarray([0, 1.609, 0]))
    receiving_antenna_surface_coords = GF.mesh_rotate(receiving_antenna_surface_coords,rotation_vector1)
    #receiving_antenna_surface_coords = GF.mesh_rotate(receiving_antenna_surface_coords,rotation_vector3)
    receiving_antenna_surface_coords = GF.mesh_translate(receiving_antenna_surface_coords,np.asarray([0, 1.609, 0]))








.. GENERATED FROM PYTHON SOURCE LINES 80-83

Create Scattering Plate
--------------------------
Create a Scattering plate a source of multipath reflections

.. GENERATED FROM PYTHON SOURCE LINES 83-101

.. code-block:: Python


    reflectorplate, scatter_points = TL.meshedReflector(
        0.3, 0.3, 6e-3, wavelength * 0.5, sides="front"
    )

    position_vector = np.asarray([29e-3, 0.0, 0])
    rotation_vector1 = np.radians(np.asarray([0.0, 90.0, 0.0]))
    scatter_points = GF.mesh_rotate(
        scatter_points,
       rotation_vector1
    )
    reflectorplate = GF.mesh_rotate(
        reflectorplate,
        rotation_vector1
    )
    reflectorplate = GF.mesh_translate(reflectorplate,position_vector)
    scatter_points = GF.mesh_translate(scatter_points,position_vector)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    meshing reflector
    args 0.3 0.3 0.006
    majorsize 0.3
    minorsize 0.3
    thickness 0.006




.. GENERATED FROM PYTHON SOURCE LINES 102-105

Specify Reflection Angle
--------------------------
Rotate the scattering plate to the optimum angle for reflection from the transmitting to receiving horn

.. GENERATED FROM PYTHON SOURCE LINES 105-121

.. code-block:: Python


    plate_orientation_angle = 45.0

    rotation_vector = np.radians(np.asarray([0.0, 0.0, plate_orientation_angle]))
    scatter_points = GF.mesh_rotate(
        scatter_points,
        rotation_vector)
    reflectorplate = GF.mesh_rotate(
        reflectorplate,
        rotation_vector
    )

    from lyceanem.base_classes import structures, points, antenna_structures

    blockers = structures([reflectorplate, receive_horn_structure, transmit_horn_structure])
    transmit_horn=antenna_structures(structures([transmit_horn_structure]), points([transmitting_antenna_surface_coords]))







.. GENERATED FROM PYTHON SOURCE LINES 122-124

Visualise the Scene Geometry
------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 124-144

.. code-block:: Python


    import pyvista as pv
    pl=pv.Plotter()
    pl.add_mesh(pv.from_meshio(scatter_points),scalars='Area')
    pl.add_mesh(pv.from_meshio(reflectorplate),color="grey")
    pl.add_mesh(pv.from_meshio(transmitting_antenna_surface_coords),scalars='Area')
    pl.add_mesh(pv.from_meshio(receiving_antenna_surface_coords),scalars='Area')
    pl.add_mesh(pv.from_meshio(receive_horn_structure),color="green")
    pl.add_mesh(pv.from_meshio(transmit_horn_structure),color="green")
    pl.add_axes()
    pl.show()

    # Specify desired Transmit Polarisation
    # --------------------------------------
    # The transmit polarisation has a significant effect on the channel characteristics. In this example the transmit
    # horn will be vertically polarised, (e-vector aligned with the y direction)

    desired_E_axis = np.zeros((1, 3), dtype=np.float32)
    desired_E_axis[0, 1] = 1.0




.. image-sg:: /auto_examples/images/sphx_glr_03_frequency_domain_channel_modelling_001.png
   :alt: 03 frequency domain channel modelling
   :srcset: /auto_examples/images/sphx_glr_03_frequency_domain_channel_modelling_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 145-151

Frequency Domain Scattering
----------------------------
Once the arrangement of interest has been setup, :func:`lyceanem.models.frequency_domain.calculate_scattering` can
be called, using raycasting to calculate the scattering parameters based upon the inputs. The scattering parameter
determines how many reflections will be considered. A value of 0 would mean only line of sight contributions will be
calculated, with 1 including single reflections, and 2 including double reflections as well.

.. GENERATED FROM PYTHON SOURCE LINES 151-182

.. code-block:: Python


    import lyceanem.models.frequency_domain as FD

    Ex, Ey, Ez = FD.calculate_scattering(
        aperture_coords=transmitting_antenna_surface_coords,
        sink_coords=receiving_antenna_surface_coords,
        antenna_solid=blockers,
        desired_E_axis=transmit_horn.excitation_function(desired_e_vector=desired_E_axis,transmit_power=0.25),
        scatter_points=scatter_points,
        wavelength=wavelength,
        scattering=0,
        project_vectors=False,
        beta=(2*np.pi)/wavelength
    )
    Excuda, Eycuda, Ezcuda = FD.calculate_scattering(
        aperture_coords=transmitting_antenna_surface_coords,
        sink_coords=receiving_antenna_surface_coords,
        antenna_solid=blockers,
        desired_E_axis=transmit_horn.excitation_function(desired_e_vector=desired_E_axis,transmit_power=0.25),
        scatter_points=scatter_points,
        wavelength=wavelength,
        scattering=0,
        project_vectors=False,
        beta=(2*np.pi)/wavelength,
        cuda=True

    )
    print("sumdiff",(np.sum((Ex-Excuda))))
    print("sumdiff",(np.sum((Ey-Eycuda))))
    print("sumdiff",(np.sum((Ez-Ezcuda))))





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    C:\Users\lycea\miniconda3\envs\CudaDevelopment\Lib\site-packages\lyceanem\electromagnetics\empropagation.py:3719: ComplexWarning: Casting complex values to real discards the imaginary part
      uvn_axes[2, :] = point_vector
    C:\Users\lycea\miniconda3\envs\CudaDevelopment\Lib\site-packages\lyceanem\electromagnetics\empropagation.py:3736: ComplexWarning: Casting complex values to real discards the imaginary part
      uvn_axes[0, :] = np.cross(local_axes[2, :], point_vector) / np.linalg.norm(
    C:\Users\lycea\miniconda3\envs\CudaDevelopment\Lib\site-packages\lyceanem\electromagnetics\empropagation.py:3758: ComplexWarning: Casting complex values to real discards the imaginary part
      uvn_axes[1, :] = np.cross(point_vector, uvn_axes[0, :]) / np.linalg.norm(
    C:\Users\lycea\miniconda3\envs\CudaDevelopment\Lib\site-packages\numba\cuda\dispatcher.py:536: NumbaPerformanceWarning: Grid size 40 will likely result in GPU under-utilization due to low occupancy.
      warn(NumbaPerformanceWarning(msg))
    scatter_source_sink
    sumdiff (-7.478353599761232e-08+4.723203539624922e-09j)
    sumdiff (4.6496070964463726e-08-1.828645673300738e-09j)
    sumdiff (-0.00036213591731276695-0.00097871361311673j)




.. GENERATED FROM PYTHON SOURCE LINES 183-188

Examine Scattering
---------------------
The resultant scattering is decomposed into the Ex,Ey,Ez components at the receiving antenna, by itself this is not
that interesting, so for this example we will rotate the reflector back, and then create a loop to step the reflector
through different angles from 0 to 90 degrees in 1 degree steps.

.. GENERATED FROM PYTHON SOURCE LINES 188-262

.. code-block:: Python



    angle_values = np.linspace(0, 90, 181)
    angle_increment = np.diff(angle_values)[0]
    responsex = np.zeros((len(angle_values)), dtype="complex")
    responsey = np.zeros((len(angle_values)), dtype="complex")
    responsez = np.zeros((len(angle_values)), dtype="complex")

    plate_orientation_angle = -45.0

    rotation_vector = np.radians(
        np.asarray([0.0, 0.0, plate_orientation_angle + 0.0])
    )
    scatter_points = GF.mesh_rotate(scatter_points,rotation_vector)
    reflectorplate = GF.mesh_rotate(reflectorplate,rotation_vector)

    from tqdm import tqdm

    for angle_inc in tqdm(range(len(angle_values))):
        rotation_vector = np.radians(np.asarray([0.0, 0.0, angle_values[angle_inc]]))
        scatter_points_temp = GF.mesh_rotate(scatter_points,rotation_vector)
        reflectorplate_temp = GF.mesh_rotate(reflectorplate,rotation_vector)
        blockers = structures([reflectorplate_temp, receive_horn_structure, transmit_horn_structure])
    
        #Scattered Path
    
        Ex, Ey, Ez = FD.calculate_scattering(
            aperture_coords=transmitting_antenna_surface_coords,
            sink_coords=scatter_points_temp,
            antenna_solid=blockers,
            desired_E_axis=transmit_horn.excitation_function(desired_e_vector=desired_E_axis,transmit_power=0.25),
            scatter_points=scatter_points_temp,
            wavelength=wavelength,
            scattering=0,
            project_vectors=False,
            beta=(2*np.pi)/wavelength
        )
        scattered_field=np.array([Ex, 
        Ey, 
        Ez]).transpose()
        
        Ex2, Ey2, Ez2 = FD.calculate_scattering(
            aperture_coords=scatter_points_temp,
            sink_coords=receiving_antenna_surface_coords,
            antenna_solid=blockers,
            desired_E_axis=scattered_field,
            scatter_points=scatter_points_temp,
            wavelength=wavelength,
            scattering=0,
            project_vectors=False,
            beta=(2*np.pi)/wavelength
        )
    
        # Line of Sight Path
    
        Ex3, Ey3, Ez3 = FD.calculate_scattering(
            aperture_coords=transmitting_antenna_surface_coords,
            sink_coords=receiving_antenna_surface_coords,
            antenna_solid=blockers,
            desired_E_axis=transmit_horn.excitation_function(desired_e_vector=desired_E_axis,transmit_power=0.25),
            scatter_points=scatter_points_temp,
            wavelength=wavelength,
            scattering=0,
            project_vectors=False,
            beta=(2*np.pi)/wavelength
        )
        responsex[angle_inc] = np.sum((Ex2+Ex3)*receiving_antenna_surface_coords.point_data["Area"])
        responsey[angle_inc] = np.sum((Ey2+Ey3)*receiving_antenna_surface_coords.point_data["Area"])
        responsez[angle_inc] = np.sum((Ez2+Ez3)*receiving_antenna_surface_coords.point_data["Area"])









.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|                                                                                                                                                                                                      | 0/181 [00:00<?, ?it/s]C:\Users\lycea\miniconda3\envs\CudaDevelopment\Lib\site-packages\numba\cuda\dispatcher.py:536: NumbaPerformanceWarning: Grid size 107 will likely result in GPU under-utilization due to low occupancy.
      warn(NumbaPerformanceWarning(msg))
      1%|█                                                                                                                                                                                             | 1/181 [00:00<00:58,  3.06it/s]      1%|██                                                                                                                                                                                            | 2/181 [00:00<00:55,  3.24it/s]      2%|███▏                                                                                                                                                                                          | 3/181 [00:00<00:50,  3.54it/s]      2%|████▏                                                                                                                                                                                         | 4/181 [00:01<00:48,  3.67it/s]      3%|█████▏                                                                                                                                                                                        | 5/181 [00:01<00:46,  3.77it/s]      3%|██████▎                                                                                                                                                                                       | 6/181 [00:01<00:45,  3.87it/s]      4%|███████▎                                                                                                                                                                                      | 7/181 [00:01<00:43,  3.96it/s]      4%|████████▍                                                                                                                                                                                     | 8/181 [00:02<00:43,  4.00it/s]      5%|█████████▍                                                                                                                                                                                    | 9/181 [00:02<00:42,  4.01it/s]      6%|██████████▍                                                                                                                                                                                  | 10/181 [00:02<00:42,  4.06it/s]      6%|███████████▍                                                                                                                                                                                 | 11/181 [00:02<00:41,  4.06it/s]      7%|████████████▌                                                                                                                                                                                | 12/181 [00:03<00:40,  4.13it/s]      7%|█████████████▌                                                                                                                                                                               | 13/181 [00:03<00:40,  4.13it/s]      8%|██████████████▌                                                                                                                                                                              | 14/181 [00:03<00:39,  4.20it/s]      8%|███████████████▋                                                                                                                                                                             | 15/181 [00:03<00:39,  4.21it/s]      9%|████████████████▋                                                                                                                                                                            | 16/181 [00:04<00:39,  4.22it/s]      9%|█████████████████▊                                                                                                                                                                           | 17/181 [00:04<00:38,  4.27it/s]     10%|██████████████████▊                                                                                                                                                                          | 18/181 [00:04<00:38,  4.28it/s]     10%|███████████████████▊                                                                                                                                                                         | 19/181 [00:04<00:38,  4.25it/s]     11%|████████████████████▉                                                                                                                                                                        | 20/181 [00:04<00:37,  4.26it/s]     12%|█████████████████████▉                                                                                                                                                                       | 21/181 [00:05<00:37,  4.29it/s]     12%|██████████████████████▉                                                                                                                                                                      | 22/181 [00:05<00:36,  4.30it/s]     13%|████████████████████████                                                                                                                                                                     | 23/181 [00:05<00:36,  4.30it/s]     13%|█████████████████████████                                                                                                                                                                    | 24/181 [00:05<00:36,  4.28it/s]     14%|██████████████████████████                                                                                                                                                                   | 25/181 [00:06<00:36,  4.24it/s]     14%|███████████████████████████▏                                                                                                                                                                 | 26/181 [00:06<00:36,  4.24it/s]     15%|████████████████████████████▏                                                                                                                                                                | 27/181 [00:06<00:35,  4.29it/s]     15%|█████████████████████████████▏                                                                                                                                                               | 28/181 [00:06<00:35,  4.28it/s]     16%|██████████████████████████████▎                                                                                                                                                              | 29/181 [00:07<00:35,  4.30it/s]     17%|███████████████████████████████▎                                                                                                                                                             | 30/181 [00:07<00:35,  4.27it/s]     17%|████████████████████████████████▎                                                                                                                                                            | 31/181 [00:07<00:34,  4.30it/s]     18%|█████████████████████████████████▍                                                                                                                                                           | 32/181 [00:07<00:34,  4.32it/s]     18%|██████████████████████████████████▍                                                                                                                                                          | 33/181 [00:07<00:33,  4.39it/s]     19%|███████████████████████████████████▌                                                                                                                                                         | 34/181 [00:08<00:33,  4.43it/s]     19%|████████████████████████████████████▌                                                                                                                                                        | 35/181 [00:08<00:32,  4.46it/s]     20%|█████████████████████████████████████▌                                                                                                                                                       | 36/181 [00:08<00:32,  4.43it/s]     20%|██████████████████████████████████████▋                                                                                                                                                      | 37/181 [00:08<00:32,  4.43it/s]     21%|███████████████████████████████████████▋                                                                                                                                                     | 38/181 [00:09<00:31,  4.47it/s]     22%|████████████████████████████████████████▋                                                                                                                                                    | 39/181 [00:09<00:31,  4.45it/s]     22%|█████████████████████████████████████████▊                                                                                                                                                   | 40/181 [00:09<00:32,  4.40it/s]     23%|██████████████████████████████████████████▊                                                                                                                                                  | 41/181 [00:09<00:32,  4.33it/s]     23%|███████████████████████████████████████████▊                                                                                                                                                 | 42/181 [00:10<00:32,  4.33it/s]     24%|████████████████████████████████████████████▉                                                                                                                                                | 43/181 [00:10<00:31,  4.32it/s]     24%|█████████████████████████████████████████████▉                                                                                                                                               | 44/181 [00:10<00:32,  4.27it/s]     25%|██████████████████████████████████████████████▉                                                                                                                                              | 45/181 [00:10<00:31,  4.26it/s]     25%|████████████████████████████████████████████████                                                                                                                                             | 46/181 [00:10<00:31,  4.26it/s]     26%|█████████████████████████████████████████████████                                                                                                                                            | 47/181 [00:11<00:31,  4.25it/s]     27%|██████████████████████████████████████████████████                                                                                                                                           | 48/181 [00:11<00:31,  4.25it/s]     27%|███████████████████████████████████████████████████▏                                                                                                                                         | 49/181 [00:11<00:31,  4.22it/s]     28%|████████████████████████████████████████████████████▏                                                                                                                                        | 50/181 [00:11<00:31,  4.12it/s]     28%|█████████████████████████████████████████████████████▎                                                                                                                                       | 51/181 [00:12<00:31,  4.12it/s]     29%|██████████████████████████████████████████████████████▎                                                                                                                                      | 52/181 [00:12<00:31,  4.13it/s]     29%|███████████████████████████████████████████████████████▎                                                                                                                                     | 53/181 [00:12<00:30,  4.16it/s]     30%|████████████████████████████████████████████████████████▍                                                                                                                                    | 54/181 [00:12<00:30,  4.18it/s]     30%|█████████████████████████████████████████████████████████▍                                                                                                                                   | 55/181 [00:13<00:29,  4.23it/s]     31%|██████████████████████████████████████████████████████████▍                                                                                                                                  | 56/181 [00:13<00:29,  4.25it/s]     31%|███████████████████████████████████████████████████████████▌                                                                                                                                 | 57/181 [00:13<00:29,  4.23it/s]     32%|████████████████████████████████████████████████████████████▌                                                                                                                                | 58/181 [00:13<00:29,  4.24it/s]     33%|█████████████████████████████████████████████████████████████▌                                                                                                                               | 59/181 [00:14<00:28,  4.25it/s]     33%|██████████████████████████████████████████████████████████████▋                                                                                                                              | 60/181 [00:14<00:28,  4.27it/s]     34%|███████████████████████████████████████████████████████████████▋                                                                                                                             | 61/181 [00:14<00:28,  4.23it/s]     34%|████████████████████████████████████████████████████████████████▋                                                                                                                            | 62/181 [00:14<00:28,  4.21it/s]     35%|█████████████████████████████████████████████████████████████████▊                                                                                                                           | 63/181 [00:15<00:27,  4.22it/s]     35%|██████████████████████████████████████████████████████████████████▊                                                                                                                          | 64/181 [00:15<00:27,  4.21it/s]     36%|███████████████████████████████████████████████████████████████████▊                                                                                                                         | 65/181 [00:15<00:27,  4.19it/s]     36%|████████████████████████████████████████████████████████████████████▉                                                                                                                        | 66/181 [00:15<00:27,  4.17it/s]     37%|█████████████████████████████████████████████████████████████████████▉                                                                                                                       | 67/181 [00:15<00:27,  4.18it/s]     38%|███████████████████████████████████████████████████████████████████████                                                                                                                      | 68/181 [00:16<00:27,  4.18it/s]     38%|████████████████████████████████████████████████████████████████████████                                                                                                                     | 69/181 [00:16<00:26,  4.18it/s]     39%|█████████████████████████████████████████████████████████████████████████                                                                                                                    | 70/181 [00:16<00:26,  4.15it/s]     39%|██████████████████████████████████████████████████████████████████████████▏                                                                                                                  | 71/181 [00:16<00:26,  4.17it/s]     40%|███████████████████████████████████████████████████████████████████████████▏                                                                                                                 | 72/181 [00:17<00:26,  4.18it/s]     40%|████████████████████████████████████████████████████████████████████████████▏                                                                                                                | 73/181 [00:17<00:25,  4.17it/s]     41%|█████████████████████████████████████████████████████████████████████████████▎                                                                                                               | 74/181 [00:17<00:25,  4.16it/s]     41%|██████████████████████████████████████████████████████████████████████████████▎                                                                                                              | 75/181 [00:17<00:25,  4.16it/s]     42%|███████████████████████████████████████████████████████████████████████████████▎                                                                                                             | 76/181 [00:18<00:25,  4.19it/s]     43%|████████████████████████████████████████████████████████████████████████████████▍                                                                                                            | 77/181 [00:18<00:24,  4.19it/s]     43%|█████████████████████████████████████████████████████████████████████████████████▍                                                                                                           | 78/181 [00:18<00:24,  4.19it/s]     44%|██████████████████████████████████████████████████████████████████████████████████▍                                                                                                          | 79/181 [00:18<00:24,  4.17it/s]     44%|███████████████████████████████████████████████████████████████████████████████████▌                                                                                                         | 80/181 [00:19<00:24,  4.20it/s]     45%|████████████████████████████████████████████████████████████████████████████████████▌                                                                                                        | 81/181 [00:19<00:23,  4.20it/s]     45%|█████████████████████████████████████████████████████████████████████████████████████▌                                                                                                       | 82/181 [00:19<00:23,  4.21it/s]     46%|██████████████████████████████████████████████████████████████████████████████████████▋                                                                                                      | 83/181 [00:19<00:23,  4.17it/s]     46%|███████████████████████████████████████████████████████████████████████████████████████▋                                                                                                     | 84/181 [00:20<00:23,  4.16it/s]     47%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                    | 85/181 [00:20<00:22,  4.27it/s]     48%|█████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                   | 86/181 [00:20<00:21,  4.36it/s]     48%|██████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                  | 87/181 [00:20<00:21,  4.42it/s]     49%|███████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                 | 88/181 [00:20<00:20,  4.49it/s]     49%|████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                | 89/181 [00:21<00:20,  4.54it/s]     50%|█████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                               | 90/181 [00:21<00:19,  4.55it/s]     50%|███████████████████████████████████████████████████████████████████████████████████████████████                                                                                              | 91/181 [00:21<00:19,  4.55it/s]     51%|████████████████████████████████████████████████████████████████████████████████████████████████                                                                                             | 92/181 [00:21<00:19,  4.57it/s]     51%|█████████████████████████████████████████████████████████████████████████████████████████████████                                                                                            | 93/181 [00:22<00:19,  4.48it/s]     52%|██████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                          | 94/181 [00:22<00:19,  4.42it/s]     52%|███████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                         | 95/181 [00:22<00:20,  4.30it/s]     53%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 96/181 [00:22<00:20,  4.22it/s]     54%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                       | 97/181 [00:22<00:19,  4.24it/s]     54%|██████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                      | 98/181 [00:23<00:19,  4.27it/s]     55%|███████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                     | 99/181 [00:23<00:19,  4.26it/s]     55%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                    | 100/181 [00:23<00:19,  4.26it/s]     56%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                   | 101/181 [00:23<00:18,  4.27it/s]     56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                  | 102/181 [00:24<00:18,  4.28it/s]     57%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                 | 103/181 [00:24<00:18,  4.27it/s]     57%|████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                | 104/181 [00:24<00:17,  4.29it/s]     58%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                               | 105/181 [00:24<00:17,  4.26it/s]     59%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                              | 106/181 [00:25<00:18,  4.16it/s]     59%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                            | 107/181 [00:25<00:17,  4.20it/s]     60%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                           | 108/181 [00:25<00:17,  4.24it/s]     60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                          | 109/181 [00:25<00:16,  4.26it/s]     61%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                         | 110/181 [00:26<00:16,  4.32it/s]     61%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                        | 111/181 [00:26<00:16,  4.35it/s]     62%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                       | 112/181 [00:26<00:15,  4.32it/s]     62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                      | 113/181 [00:26<00:15,  4.32it/s]     63%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                     | 114/181 [00:26<00:15,  4.40it/s]     64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 115/181 [00:27<00:14,  4.45it/s]     64%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                   | 116/181 [00:27<00:14,  4.49it/s]     65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                  | 117/181 [00:27<00:14,  4.48it/s]     65%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                 | 118/181 [00:27<00:14,  4.48it/s]     66%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                | 119/181 [00:28<00:13,  4.50it/s]     66%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                               | 120/181 [00:28<00:13,  4.54it/s]     67%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                              | 121/181 [00:28<00:13,  4.51it/s]     67%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                             | 122/181 [00:28<00:13,  4.44it/s]     68%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                            | 123/181 [00:28<00:13,  4.38it/s]     69%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                           | 124/181 [00:29<00:13,  4.32it/s]     69%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                          | 125/181 [00:29<00:13,  4.28it/s]     70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                         | 126/181 [00:29<00:12,  4.27it/s]     70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                        | 127/181 [00:29<00:12,  4.16it/s]     71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                       | 128/181 [00:30<00:12,  4.15it/s]     71%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                      | 129/181 [00:30<00:12,  4.19it/s]     72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                     | 130/181 [00:30<00:12,  4.24it/s]     72%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                    | 131/181 [00:30<00:12,  4.11it/s]     73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 132/181 [00:31<00:11,  4.16it/s]     73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                 | 133/181 [00:31<00:11,  4.32it/s]     74%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                | 134/181 [00:31<00:10,  4.45it/s]     75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                               | 135/181 [00:31<00:10,  4.54it/s]     75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                              | 136/181 [00:31<00:09,  4.64it/s]     76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                             | 137/181 [00:32<00:09,  4.71it/s]     76%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 138/181 [00:32<00:09,  4.71it/s]     77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                           | 139/181 [00:32<00:08,  4.67it/s]     77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                          | 140/181 [00:32<00:08,  4.65it/s]     78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                         | 141/181 [00:33<00:08,  4.55it/s]     78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                        | 142/181 [00:33<00:08,  4.56it/s]     79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                       | 143/181 [00:33<00:08,  4.48it/s]     80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                      | 144/181 [00:33<00:08,  4.43it/s]     80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                     | 145/181 [00:33<00:08,  4.38it/s]     81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                    | 146/181 [00:34<00:08,  4.37it/s]     81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                   | 147/181 [00:34<00:07,  4.33it/s]     82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                  | 148/181 [00:34<00:07,  4.35it/s]     82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 149/181 [00:34<00:07,  4.35it/s]     83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                | 150/181 [00:35<00:07,  4.36it/s]     83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                               | 151/181 [00:35<00:06,  4.37it/s]     84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                              | 152/181 [00:35<00:06,  4.37it/s]     85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                             | 153/181 [00:35<00:06,  4.14it/s]     85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                            | 154/181 [00:36<00:07,  3.76it/s]     86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                           | 155/181 [00:36<00:08,  3.11it/s]     86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                          | 156/181 [00:36<00:07,  3.20it/s]     87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                         | 157/181 [00:37<00:07,  3.42it/s]     87%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                        | 158/181 [00:37<00:06,  3.53it/s]     88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                      | 159/181 [00:37<00:05,  3.71it/s]     88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                     | 160/181 [00:37<00:05,  3.87it/s]     89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    | 161/181 [00:38<00:04,  4.02it/s]     90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                   | 162/181 [00:38<00:04,  4.13it/s]     90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 163/181 [00:38<00:04,  4.18it/s]     91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                 | 164/181 [00:38<00:04,  4.19it/s]     91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 165/181 [00:39<00:03,  4.26it/s]     92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍               | 166/181 [00:39<00:03,  4.33it/s]     92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 167/181 [00:39<00:03,  4.40it/s]     93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍             | 168/181 [00:39<00:02,  4.45it/s]     93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 169/181 [00:39<00:02,  4.46it/s]     94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 170/181 [00:40<00:02,  4.51it/s]     94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 171/181 [00:40<00:02,  4.51it/s]     95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋         | 172/181 [00:40<00:01,  4.51it/s]     96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 173/181 [00:40<00:01,  4.45it/s]     96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋       | 174/181 [00:41<00:01,  4.39it/s]     97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 175/181 [00:41<00:01,  4.33it/s]     97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊     | 176/181 [00:41<00:01,  4.30it/s]     98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 177/181 [00:41<00:00,  4.22it/s]     98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 178/181 [00:41<00:00,  4.14it/s]     99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 179/181 [00:42<00:00,  4.22it/s]     99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 180/181 [00:42<00:00,  4.32it/s]    100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 181/181 [00:42<00:00,  4.46it/s]    100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 181/181 [00:42<00:00,  4.24it/s]




.. GENERATED FROM PYTHON SOURCE LINES 263-266

Plot Normalised Response
----------------------------
Using matplotlib, plot the results

.. GENERATED FROM PYTHON SOURCE LINES 266-295

.. code-block:: Python


    import matplotlib.pyplot as plt

    normalised_max = np.max(
        np.array(
            [
                np.max(20 * np.log10(np.abs(responsex))),
                np.max(20 * np.log10(np.abs(responsey))),
                np.max(20 * np.log10(np.abs(responsez))),
            ]
        )
    )
    ExdB = 20 * np.log10(np.abs(responsex)) - normalised_max
    EydB = 20 * np.log10(np.abs(responsey)) - normalised_max
    EzdB = 20 * np.log10(np.abs(responsez)) - normalised_max

    fig, ax = plt.subplots()
    ax.plot(angle_values - 45, ExdB, label="Ex")
    ax.plot(angle_values - 45, EydB, label="Ey")
    ax.plot(angle_values - 45, EzdB, label="Ez")
    plt.xlabel("$\\theta_{N}$ (degrees)")
    plt.ylabel("Normalised Level (dB)")
    ax.set_ylim(-40.0, 0)
    ax.set_xlim(np.min(angle_values) - 45, np.max(angle_values) - 45)
    ax.set_xticks(np.linspace(np.min(angle_values) - 45, np.max(angle_values) - 45, 19))
    ax.set_yticks(np.linspace(-40, 0.0, 21))
    legend = ax.legend(loc="upper right", shadow=True)
    plt.grid()
    plt.show()



.. image-sg:: /auto_examples/images/sphx_glr_03_frequency_domain_channel_modelling_002.png
   :alt: 03 frequency domain channel modelling
   :srcset: /auto_examples/images/sphx_glr_03_frequency_domain_channel_modelling_002.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 43.386 seconds)


.. _sphx_glr_download_auto_examples_03_frequency_domain_channel_modelling.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: 03_frequency_domain_channel_modelling.ipynb <03_frequency_domain_channel_modelling.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: 03_frequency_domain_channel_modelling.py <03_frequency_domain_channel_modelling.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: 03_frequency_domain_channel_modelling.zip <03_frequency_domain_channel_modelling.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
